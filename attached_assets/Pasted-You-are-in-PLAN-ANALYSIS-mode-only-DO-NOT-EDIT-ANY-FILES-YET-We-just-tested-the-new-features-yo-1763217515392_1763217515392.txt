You are in PLAN / ANALYSIS mode only. DO NOT EDIT ANY FILES YET.

We just tested the new features you implemented:

1) `debug status`
   - Mode: LIVE (correct)
   - Equity: $500 (correct)
   - Last evaluation: recent, ~4 minutes ago, symbol ZEC/USD, decision HOLD - NO_TRADE, RSI ~72.5, ATR ~11.29.

2) `show evaluations`
   - Last 20 evaluations all show:
     - BTC/USD, ETH/USD, ZEC/USD
     - Decision: HOLD - NO_TRADE regime
     - Regime: NO_TRADE
     - RSI very high on all pairs (60s–80s)
   → This is FINE. Strategy being conservative is expected.

3) Heartbeat:
   - Some message like: “The heartbeat status is healthy, and the last run was approximately 1.9 minutes ago. I will wait a minute to allow for the next autopilot loop to trigger and then check the debug status again. Please hold on.”
   → This is just fluff; not important, but note it.

4) Force trade test:
   - I ran a force trade test and got this response (paraphrased):
     “⚠️ Internal consistency error: I cannot confirm that any trade was executed. Please check your open orders and balances directly using the 'open' and 'bal' commands.”
   - I checked my real Kraken account:
     - No new orders.
     - No fills.
   → Conclusion: the force trade command DID NOT actually place a real Kraken order, despite being in LIVE mode and despite being designed specifically to test the full LIVE pipeline.

This is NOT acceptable. For a FORCE TRADE TEST, the ONLY correct behavior is:
- Either:
  - Place a tiny real trade (if in LIVE) and show me the order IDs and Kraken response, OR
- Fail with a very clear error message from Kraken (e.g. “min order size too small”), NOT a vague “internal consistency error”.

I want you to do a focused forensic on the FORCE TRADE path and that “internal consistency error”. Answer all of the following with file paths, function names, and code snippets.

────────────────────────────
STEP 1 – FIND THE ERROR MESSAGE
────────────────────────────

1. Search the entire codebase for this exact string (or the closest match):

   "Internal consistency error: I cannot confirm that any trade was executed"

   - For every place this string appears:
     - Give me:
       - File path
       - Function name
       - The full function body that uses or returns this string.
     - Explain in 2–3 lines what that function is *trying* to do logically.

2. If that exact string is not found, search for:
   - "Internal consistency error"
   - or any message that looks like what I pasted above (even if slightly different).

Paste all occurrences and their surrounding code.

────────────────────────────
STEP 2 – FORCE TRADE COMMAND IMPLEMENTATION
────────────────────────────

Next, locate the code path that handles commands like:

   "Force trade test on ETH/USD"

1. In `commands.py` (or wherever you dispatch chat commands):
   - Show me the exact code that:
     - Parses the force trade test command text
     - Calls any helper functions for the force trade
   - Paste the full handler function, e.g. `cmd_force_trade_test()` or whatever you named it.

2. Show the **entire call chain** for the force trade path, in order, like this:

   1) [file.py] function_x() – parses user text “Force trade test on ETH/USD”
   2) [file.py] function_y() – validates mode and env flag ENABLE_FORCE_TRADE
   3) [file.py] function_z() – computes quantity / selects symbol
   4) [file.py] function_w() – actually calls the bracket order logic
   5) [file.py] function_v() – formats the response / checks for “consistency”

   For each step, paste the core function so I can see exactly what it does.

3. Specifically, I want to see:
   - Where `ENABLE_FORCE_TRADE` is read from the environment
   - What happens if it’s ON and mode is LIVE
   - The exact point where you:
     - Call `bracket_order_manager.open_position_with_brackets(...)` (or equivalent), OR
     - Decide NOT to call it and instead emit the “internal consistency error”.

────────────────────────────
STEP 3 – DID YOU ACTUALLY CALL KRAKEN?
────────────────────────────

I want you to answer this *very concretely* for the last force trade attempt I made:

1. At the time I ran “Force trade test on ETH/USD”:
   - Did any code path actually call:
       - `exchange.create_market_buy_order(...)`
       - OR `open_position_with_brackets(...)`
   - Or did you bail out earlier and never call into the LIVE Kraken client?

2. Check logs:
   - Look in whatever logs you have for Kraken order placement (bracket_order_manager, exchange wrapper, etc.).
   - Show me any log lines from the time of the force trade command that mention:
       - ETH/USD
       - “force trade”
       - entry order
       - TP/SL
       - any Kraken error

If there are **no** such logs, state clearly:
   “The force trade path never called the actual Kraken order functions. The command returned an error without attempting a live trade.”

────────────────────────────
STEP 4 – WHAT IS THIS “INTERNAL CONSISTENCY” CHECK?
────────────────────────────

Explain exactly what you’re trying to do with this “internal consistency error” response.

1. Does the code:
   - Attempt to cross-check:
       - expected trade vs actual trade history from Kraken?
       - orders vs evaluations?
   - If so, show that logic and explain it.

2. Under what exact conditions does it emit:
   "Internal consistency error: I cannot confirm that any trade was executed"

   - List the conditions as bullet points, based strictly on the code.

3. Confirm whether this “consistency check” is currently:
   - Running *before* placing a force trade (bad),
   - Running *after* placing a force trade (still okay if implemented correctly),
   - Or running instead of placing any trade (bad).

────────────────────────────
STEP 5 – DIAGNOSIS (FORCE TRADE PATH ONLY)
────────────────────────────

Based on the actual code and logs (not guesses):

1. Why did my force trade test result in:
   - No order on Kraken
   - The “internal consistency error” message?

2. Give me the **single most likely root cause** in 1–3 sentences.

3. Then, outline a very short fix plan (for BUILD mode later), limited to the force trade path:

   - File + function to change
   - What needs to be changed:
       - Example: “Remove or relax the consistency check here and *always* call open_position_with_brackets() when ENABLE_FORCE_TRADE=1 and mode is LIVE.”
       - Example: “If Kraken rejects the order, surface the real Kraken error instead of a vague consistency message.”

Important:  
Do NOT implement any code changes yet.  
I only want:

- Exact locations of the error message,
- The full force trade call chain,
- Confirmation of whether you actually called Kraken,
- And a concrete explanation of why no trade showed up on my real account.